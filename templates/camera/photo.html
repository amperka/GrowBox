{% extends "base.html" %}

{% block scriptsSection %}
<script>
    function request_photo(url, id) {
		var xhr = new XMLHttpRequest();
		xhr.open('GET', url, true);
		xhr.send();
		xhr.onreadystatechange = function() {
			if (xhr.readyState != 4) return;

			if (xhr.status != 200) {
				alert(xhr.status + ': ' + xhr.statusText);
			} else {
				alert("OK");
				var img = new Image(500, 500);
				if (id == 'image1') {
					img.src = "../../static/img/img1.jpg?" + Math.random();
				} else if (id == 'image2') {
					img.src = "../../static/img/img2.jpg?" + Math.random();
				}
				img.onload = function () {
					document.getElementById(id).src = img.src;
				}
			}

		}
	}

	function clear_photo() {
		var xhr = new XMLHttpRequest();
		xhr.open('GET', '/clear_photo', true);
		xhr.send();
		xhr.onreadystatechange = function() {
			if (xhr.readyState != 4) return;

			if (xhr.status != 200) {
				alert(xhr.status + ': ' + xhr.statusText);
			} else {
				alert("OK");
				location.reload(true);
			}
		}

	}
</script>
{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col">
			<div class="row py-2">
                <!-- Сделать 1-ый снимок -->
                <button type="button" class="btn btn-success btn-lg btn-block p-3" onclick="request_photo('/make_photo/img1', 'image1')" >
                    <p class="h2">Сделать 1-ый снимок</p>
                </button>
            </div>

			<div class="row py-2">
                <!-- Сделать 2-ой снимок -->
                <button type="button" class="btn btn-success btn-lg btn-block p-3" onclick="request_photo('/make_photo/img2', 'image2')">
                    <p class="h2">Сделать 2-ой снимок</p>
                </button>
            </div>

			<div class="row py-2">
                <!-- Очистить фото -->
                <button type="button" class="btn btn-danger btn-lg btn-block p-3" onclick="clear_photo()">
                    <p class="h2">Очистить фото</p>
                </button>
            </div>

			<div class="row pt-4 pb-2 d-flex justify-content-center">
				<img src= "../../static/img/loading.gif" alt="Фотография №1" id="image1">
			</div>
			<div class="row pt-2 pb-4 d-flex justify-content-center">
				<img src= "../../static/img/loading.gif" alt="Фотография №2" id="image2">
			</div>
        </div>
    </div>
</div>
{% endblock %}
